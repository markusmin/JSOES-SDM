---
title: "FISH 556: Final Project"
author: "Markus Min"
date: "`r Sys.Date()`"
output:
  pdf_document: default
---

```{r chunk-options, message = FALSE, echo = FALSE, warning = FALSE}
# set chunk options
knitr::opts_chunk$set(message = FALSE, echo = FALSE, warning = FALSE)
```


```{r load-libraries-reformat-data}

library(tidyverse)
library(here)
library(readxl)
library(janitor)
library(sf)
library(sdmTMB)
library(rnaturalearth)
library(sdmTMBextra)
library(fmesher)

jsoes <- clean_names(read_excel(here::here("Data", "Markus_Min_Trawl_CTD_Chl_Nuts_Thorson_Scheuerell_5.2.24_FINAL.xlsx")))
```

## Model equation

$$
log(d_{s,t}) \sim \beta_t + \textbf{x}_{s,t}\gamma + \omega_s + \epsilon_{s,t} \\
\omega \sim \textrm{MVN}(\textbf{0},\sigma_w^2\textbf{R}_w) \\
\epsilon_t \sim \textrm{MVN}(\textbf{0},\sigma_\epsilon^2\textbf{R}_\epsilon)
$$

Where:
- $s$ is the station
- $t$ is the year
- $d$ is the density of a species caught in a tow
- $\beta_t$ is the median density in year t
- $\textbf{x}_{s,t}$ is the vector of density covariates at station $s$ in year $t$
- $\gamma$ is the vector of parameters describing the effect of density covariates
- $\omega_s$ is the density for location $s$ relative to the median location that is typical across years
- $\epsilon_{s,t}$ is a spatio-temporal variable
- $\sigma_\omega^2$ is the spatial variance
- $\sigma_\epsilon^2$ is the spatio-temporal variance


$\textbf{x}_{s,t}$ includes the following parameters whose effects are described in $\gamma$:
- SST
- more...

### bespoke TMB implementation
```{r}


set.seed(556)


```



### sdmTMB package implementation






